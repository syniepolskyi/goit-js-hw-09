{"mappings":"gfAAA,IAAAA,EAAAC,EAAA,SAGA,SAASC,EAAcC,EAAUC,GAC/B,IAAMC,EAAgBC,KAAKC,SAAW,GAYtC,OAVgB,IAAIC,SAAQ,SAACC,EAASC,GACpCC,YAAW,WACLN,EACFI,EAAQ,CAACN,SAASA,EAAUC,MAAMA,IAElCM,EAAO,CAACP,SAASA,EAAUC,MAAMA,G,GAElCA,E,IAsEMQ,SAASC,cAAc,aAE/BC,iBAAiB,UAAU,SAACC,GAlEjC,IAAkBC,EACVC,GAkENF,EAAGG,iBACAH,EAAGI,cAAcC,aAAa,cApEjBJ,EAuEHD,EAAGI,cAtEVF,EAAa,CACjBI,OAAS,SAACC,GACR,IAAIC,GAASC,MAAMF,IAAUA,EAAQ,EAIrC,OAHIC,GACFvB,EAAAyB,OAAOC,QAAS,8BAEXH,C,EAETnB,MAAO,SAACkB,GACN,IAAIC,GAASC,MAAMF,IAAUA,GAAS,EAItC,OAHIC,GACFvB,EAAAyB,OAAOC,QAAS,8BAEXH,C,EAETI,KAAM,SAACL,GACL,IAAIC,GAASC,MAAMF,IAAUA,GAAS,EAItC,OAHIC,GACFvB,EAAAyB,OAAOC,QAAS,6BAEXH,C,GAGJK,OAAOC,KAAKZ,GAAYa,QAAO,SAACC,EAAIC,GACzC,IAAIC,EAAIC,SAASlB,EAAKmB,SAASH,GAAKV,MAAM,IACtCC,EAAQN,EAAWe,GAAKC,GAC5B,OAAOF,GAAOR,C,IACb,IAGL,SAAoBa,GACKA,EAAlBjC,SAAL,IAAekC,EAAQD,EAARE,KACTC,EAAQF,EAAKF,SACbd,EAASa,SAASK,EAAc,OAAEjB,MAAM,IACxCkB,EAAQN,SAASK,EAAa,MAAEjB,MAAM,IACtCK,EAAOO,SAASK,EAAY,KAAEjB,MAAM,IACtCmB,EAAYd,EAChBU,EAAKK,aAAa,UAAU,QAC5BD,EAAYD,EAMZ,IALA,IAAMG,EAAa,SAACxC,GACfA,IAAakB,GACdgB,EAAKO,gBAAgB,U,EAGhBC,EAAI,EAAGA,EAAIxB,EAAQwB,IACV3C,EAAc2C,EAAE,EAAGJ,GAC3BK,MAAK,SAACC,GACZ,IAAO5C,EAAmB4C,EAAnB5C,SAAUC,EAAS2C,EAAT3C,MACjBJ,EAAAyB,OAAOuB,QAAQ,uBAAwCC,OAAf9C,EAAS,QAAY8C,OAAN7C,EAAM,OAC3DuC,EAASxC,E,IAEZ+C,OAAM,SAACH,GACN,IAAO5C,EAAmB4C,EAAnB5C,SAAUC,EAAS2C,EAAT3C,MACjBJ,EAAAyB,OAAO0B,QAAQ,sBAAqCF,OAAf9C,EAAS,QAAY8C,OAAN7C,EAAM,OAC1DuC,EAAWxC,E,IAEbsC,GAAad,C,CAqBfyB,CAJa,CACXjD,SAAU,EACVmC,KAAMvB,EAAGI,gB","sources":["src/js/03-promises.js"],"sourcesContent":["import { Notify } from 'notiflix/build/notiflix-notify-aio'\nimport \"notiflix/dist/notiflix-3.2.5.min.css\"\n\nfunction createPromise(position, delay) {\n  const shouldResolve = Math.random() > 0.3;\n\n  const promise = new Promise((resolve, reject) => {\n    setTimeout(() => {\n      if (shouldResolve) {\n        resolve({position:position, delay:delay});\n      } else {\n        reject({position:position, delay:delay});\n      }\n    }, delay);\n  });\n\n  return promise;\n}\n\nfunction validate(form){\n  const validators = {\n    amount : (value) => {\n      let valid = !isNaN(value) && value > 0\n      if(!valid){\n        Notify.warning(`amount must be integer > 0`)\n      }\n      return valid\n    }, \n    delay: (value) => {\n      let valid = !isNaN(value) && value >= 0\n      if(!valid){\n        Notify.warning(`delay must be integer >= 0`)\n      }\n      return valid\n    }, \n    step: (value) => {\n      let valid = !isNaN(value) && value >= 0\n      if(!valid){\n        Notify.warning(`step must be integer >= 0`)\n      }\n      return valid\n    }\n  }\n  return Object.keys(validators).reduce((acc,key) =>{\n    let v = parseInt(form.elements[key].value,10)\n    let valid = validators[key](v)\n    return acc && valid\n  }, true)\n}\n\nfunction doPromises(data){\n  let {position, form} = data\n  const elems = form.elements\n  const amount = parseInt(elems['amount'].value,10)\n  const delay = parseInt(elems['delay'].value,10)\n  const step = parseInt(elems['step'].value,10)\n  let currDelay = step\n  form.setAttribute(\"pending\",\"true\")\n  currDelay = delay\n  const unblocking = (position) =>{\n    if(position === amount){\n      form.removeAttribute(\"pending\")\n    }\n  }\n  for (let i = 0; i < amount; i++){\n    const promise = createPromise(i+1, currDelay)\n    promise.then((data) => {\n      const {position, delay} = data\n      Notify.success(`✅ Fulfilled promise ${position} in ${delay}ms`)\n      unblocking(position)\n    })\n    .catch((data) => {\n      const {position, delay} = data\n      Notify.failure(`❌ Rejected promise ${position} in ${delay}ms`)\n      unblocking(position)\n    })\n    currDelay += step\n  }\n\n\n}\n\n\nconst form = document.querySelector('form.form')\n\nform.addEventListener(\"submit\", (ev) => {\n  ev.preventDefault()\n  if(ev.currentTarget.getAttribute(\"pending\")){\n    return\n  }\n  if(!validate(ev.currentTarget)){\n    return\n  }\n  const data = {\n    position: 1,\n    form: ev.currentTarget\n  }\n  doPromises(data)\n})\n\n\n"],"names":["$h6c0i","parcelRequire","$ce04d3a99e08e73b$var$createPromise","position","delay","shouldResolve","Math","random","Promise","resolve","reject","setTimeout","document","querySelector","addEventListener","ev","form1","validators","preventDefault","currentTarget","getAttribute","amount","value","valid","isNaN","Notify","warning","step","Object","keys","reduce","acc","key","v","parseInt","elements","data1","form2","form","elems","delay1","currDelay","setAttribute","unblocking","removeAttribute","i","then","data","success","concat","catch","failure","$ce04d3a99e08e73b$var$doPromises"],"version":3,"file":"03-promises.9ab392b8.js.map"}